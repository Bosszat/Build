-- =============== CONFIG ===============
getgenv().autoCollect = false -- เปิด/ปิด Auto Collect
getgenv().webhookUrl = "https://discord.com/api/webhooks/1426125319173312512/RNARiWMk90CSwn89ypi8Gv_lufMnJff3zu4_RCAsvF96XXVWwzPLp0RzSgMS8Ml0JY78"
getgenv().delay = 300
getgenv().whitelist = {
    Pets = { "bear" },
    Eggs = {},
    Fruits = {}
}

-- HTTP request helper (รองรับหลาย executor)
local httpRequest = (syn and syn.request)
    or (http and http.request)
    or http_request
    or request

-- =============== SERVICES & PLAYER ===============
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local Workspace = game:GetService("Workspace")

local function getCharacter()
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")
    return char, hrp
end
local Character, HumanoidRootPart = getCharacter()
LocalPlayer.CharacterAdded:Connect(function()
    Character, HumanoidRootPart = getCharacter()
end)

-- =============== ANTI-AFK ===============
pcall(function()
    local VirtualUser = game:GetService("VirtualUser")
    LocalPlayer.Idled:Connect(function()
        VirtualUser:Button2Down(Vector2.new(0,0), Workspace.CurrentCamera.CFrame)
        task.wait(1)
        VirtualUser:Button2Up(Vector2.new(0,0), Workspace.CurrentCamera.CFrame)
        print("⚠️ Anti-AFK activated!")
    end)
end)

-- =============== AUTOCOLLECT LOOP ===============
task.spawn(function()
    while task.wait(0.1) do
        if getgenv().autoCollect and HumanoidRootPart and Workspace:FindFirstChild("Pets") then
            for _, pet in ipairs(Workspace.Pets:GetChildren()) do
                if pet:GetAttribute("UserId") == LocalPlayer.UserId then
                    pcall(function()
                        firetouchinterest(HumanoidRootPart, pet, 1)
                        task.wait(0.1)
                        firetouchinterest(HumanoidRootPart, pet, 0)
                    end)
                end
            end
        end
    end
end)

-- =============== UI ===============
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.ResetOnSpawn = false
ScreenGui.Name = "DinoHelperUI"
ScreenGui.Parent = game:GetService("CoreGui")

local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0, 160, 0, 40)
ToggleButton.Position = UDim2.new(0, 50, 0, 100)
ToggleButton.BackgroundColor3 = Color3.new(0.8, 0, 0)
ToggleButton.Text = "Auto Collect: OFF"
ToggleButton.Font = Enum.Font.SourceSansBold
ToggleButton.TextSize = 18
ToggleButton.TextColor3 = Color3.new(1, 1, 1)
ToggleButton.Parent = ScreenGui

local function refreshToggle()
    local on = getgenv().autoCollect
    ToggleButton.Text = "Auto Collect: " .. (on and "ON" or "OFF")
    ToggleButton.BackgroundColor3 = on and Color3.new(0, 0.8, 0.2) or Color3.new(0.8, 0, 0)
end
ToggleButton.MouseButton1Click:Connect(function()
    getgenv().autoCollect = not getgenv().autoCollect
    refreshToggle()
end)
refreshToggle()

-- =============== DATA HELPERS ===============
local function getDataFolder()
    return LocalPlayer.PlayerGui:FindFirstChild("Data")
end

local function getEggData(dataContainer)
    local eggCounts, totalEggs = {}, 0
    local eggDataFolder = dataContainer and dataContainer:FindFirstChild("Egg")
    local wl = getgenv().whitelist.Eggs
    local useWL = wl and #wl > 0
    if eggDataFolder then
        for _, eggData in ipairs(eggDataFolder:GetChildren()) do
            if eggData:IsA("Configuration") and not eggData:GetAttribute("D") then
                local t = eggData:GetAttribute("T")
                if t and (not useWL or table.find(wl, t)) then
                    local m = eggData:GetAttribute("M") or ""
                    local key = t .. "_" .. m
                    local name = (m ~= "" and (t .. " (" .. m .. ")")) or t
                    eggCounts[key] = eggCounts[key] or { name = name, count = 0 }
                    eggCounts[key].count = eggCounts[key].count + 1
                end
                totalEggs = totalEggs + 1
            end
        end
    end
    return eggCounts, totalEggs
end

local function getPetData(dataContainer)
    local petCounts, totalPets = {}, 0
    local petDataFolder = dataContainer and dataContainer:FindFirstChild("Pets")
    local wl = getgenv().whitelist.Pets
    local useWL = wl and #wl > 0
    if petDataFolder then
        for _, petData in ipairs(petDataFolder:GetChildren()) do
            if petData:IsA("Configuration") and not petData:GetAttribute("D") then
                local t = petData:GetAttribute("T")
                if t and (not useWL or table.find(wl, t)) then
                    local m = petData:GetAttribute("M") or ""
                    local key = t .. "_" .. m
                    local name = (m ~= "" and (t .. " (" .. m .. ")")) or t
                    petCounts[key] = petCounts[key] or { name = name, count = 0 }
                    petCounts[key].count = petCounts[key].count + 1
                end
                totalPets = totalPets + 1
            end
        end
    end
    return petCounts, totalPets
end

local function getFruitData(dataContainer)
    local fruitCounts = {}
    local assetData = dataContainer and dataContainer:FindFirstChild("Asset")
    local wl = getgenv().whitelist.Fruits
    local useWL = wl and #wl > 0
    if assetData then
        for fruitName, count in pairs(assetData:GetAttributes()) do
            if type(count) == "number" and count > 0 then
                if (not useWL) or table.find(wl, fruitName) then
                    fruitCounts[fruitName] = count
                end
            end
        end
    end
    return fruitCounts
end

local function formatTable(tbl)
    local lines = {}
    for name, info in pairs(tbl) do
        if typeof(info) == "table" then
            table.insert(lines, string.format("%
